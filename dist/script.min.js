$(document).ready(function(){$("#todo-form").on("submit",function(t){t.preventDefault();let e=$("#todo-input").val();e=(e=(e=e.trim()).charAt(0).toUpperCase()+e.slice(2)).replace(/\s+/g," ");let n=$("<li></li>");if(""===e)return alert("Please enter a value");$("#todo-list").append(n),$("#todo-input").val("");let a=$("<input></input>");a.attr("type","checkbox"),a.attr("id","checkbox"),a.attr("class","checkbox"),a.prependTo(n),a.on("click",function(){n.toggleClass("strike")}),n.on("dblclick",function(){$(this).toggleClass("strike")});let i=$("<div></div>"),d=$("<button></button>");d.addClass("btn-primary"),d.text("Edit");let o=$("<button></button>");o.addClass("btn-danger"),o.text("Delete"),o.on("click",function(){a.prop("checked")?a.prop("checked")?!0===confirm("Are you sure you want to delete this task?")&&(n.remove(),localStorage.removeItem("todoList",JSON.stringify(e))):AbortController():alert("Please mark the task as completed before deleting it")}),i.append(d),i.append(o),n.attr("draggable",!0),n.on("dragstart",function(t){t.originalEvent.dataTransfer.setData("text/plain",n.index())});let l=$("#todo-list li"),s=[];for(let p=0;p<l.length;p++)p===l.length-1?s.push(e):s.push(l[p].innerText.slice(0,-10));localStorage.setItem("todoList",JSON.stringify(s)),n.append(e),n.append(i)});let t=document.getElementById("todo-list");t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(t){t.preventDefault();let e=t.dataTransfer.getData("text/plain"),n=$("#todo-list li").eq(e),a=$(t.target).closest("li").index();e!==a.toString()&&(n.detach(),e<a?$(t.target).closest("li").after(n):$(t.target).closest("li").before(n))});let e=JSON.parse(localStorage.getItem("todoList"));$(".button").on("click",function(){for(let t=0;t<e.length;t++){let n=$("<li></li>");n.append(e[t]),$("#todo-list").append(n),n.on("dblclick",function(){$(this).toggleClass("strike")});let a=$("<input></input>");a.attr("type","checkbox"),a.attr("id","checkbox"),a.attr("class","checkbox"),a.prependTo(n),a.on("click",function(){n.toggleClass("strike")});let i=$("<div></div>"),d=$("<button></button>");d.addClass("btn-primary"),d.text("Edit");let o=$("<button></button>");o.addClass("btn-danger"),o.text("Delete"),o.on("click",function(){a.prop("checked")?a.prop("checked")?!0===confirm("Are you sure you want to delete this task?")&&(n.remove(),localStorage.removeItem("todoList",JSON.stringify(e[0]))):(AbortController(),location.replace(location.href.split("#")[0])):alert("Please mark the task as completed before deleting it")}),d.on("click",function(){let t=$("<div></div>");t.addClass("modal"),t.attr("id","edit-modal");let e=$("<div></div>");e.addClass("modal-header");let a=$("<h2></h2>");a.text("Edit Todo");let d=$("<div></div>");d.addClass("modal-body text-center");let o=$("<div></div>");o.addClass("modal-content");let l=$("<div></div>");l.addClass("modal-footer");let s=$("<span></span>");s.addClass("close"),s.text("X");let p=$("<input></input>");p.attr("type","text"),p.attr("id","edit-input"),p.val(n.text().slice(0,-10));let r=$("<button></button>");r.addClass("btn-primary"),r.text("Save"),e.append(a),e.append(s),d.append(p),l.append(r),o.append(e),o.append(d),o.append(l),t.append(o),$("body").append(t),$("#edit-modal").css("display","block"),s.on("click",function(){$("#edit-modal").css("display","none")}),r.on("click",function(){let t=$("#edit-input").val();t=(t=(t=t.trim()).charAt(0).toUpperCase()+t.slice(1)).replace(/\s+/g," ");let e=$("#edit-input").val(),a=$("#todo-list li").index(n),d=$("#todo-list li"),o=[];for(let l=0;l<d.length;l++)l===a?o.push(e):o.push(d[l].innerText.slice(0,-10));localStorage.setItem("todoList",JSON.stringify(o)),n.text(t),n.append(i),$("#edit-modal").css("display","none")}),t.on("click",function(e){e.target===t[0]&&t.css("display","none")}),window.addEventListener("keydown",function(e){"Escape"===e.key&&t.css("display","none")})}),i.append(d),i.append(o),n.append(i),n.attr("draggable",!0),n.on("dragstart",function(t){t.originalEvent.dataTransfer.setData("text/plain",n.index())})}})});